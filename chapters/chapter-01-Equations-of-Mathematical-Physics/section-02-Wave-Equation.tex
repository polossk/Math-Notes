\section{波动方程}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 3.}
用特征线法求解 Cauchy 问题:
\[ \begin{cases}
u_t + 2u_x + u = xt, & t > 0, -\infty < x < \infty \\
\mfwhen{u}{t=0} = 2 - x, & -\infty < x < \infty
\end{cases} \]

\begin{solution}
易知特征线 $\diff x /\diff t = 2 - x$, 即 $x = x(t, c) = 2t + c$.

沿特征线方向, 有
\[ \begin{equlist}
\frac{\diff u(x(t, c), t)}{\diff t} &= xt - u = 2t^2 + ct - u(x(t, c), t) \\
    u(c, 0) &= 2 - c;
\end{equlist} \]
原方程可以化简为:
\begin{align*}
&\me^t u(x(t, c), t) - (2 - t) = \int_0^t (2t^2+ct)\diff t
    = \frac23 t^3 + \frac{c}{2} t^2 \\
&u(x(t,c),t) = (2+c)\left(\frac23 t^3+\frac{c}{2}t^2\right)\me^{-t} \\
&u(x,t) = \left[x - 2t+ 2 - \frac{t^3}{3}  + \frac{xt^2}{2} \right] \me^{-t}
\end{align*}
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 9.}
求解并证明初值问题:
\[ \begin{cases}
u_{tt} - a^2 u_{xx} + cu = f(x, t) \\
\mfwhen{u}{t=0} = \phi(x) \\
\mfwhen{u_t}{t=0} = \psi(x) \\
-\infty < x < \infty, t > 0
\end{cases} \]
解的唯一性, 其中 $c$ 为常数.

\begin{solution}
对于波动方程左右两边同乘上 $u_t$, 得到
$(u_{tt} - a^2 u_{xx} + cu) u_t = f(x, t) u_t$, 设其特征锥为 $K$,
$0 \leq \tau \leq t_0$, $K_\tau = K \cap \{0 \leq \tau \leq t_0\}$,
$\Omega_\tau = K \cap \{t = \tau\}$, 令方程在 $K_\tau$ 积分, 得到
\begin{align*}
&\iint_{K_\tau} [ u_t(u_{tt} - a^2 u_{xx}) + c u u_t ] \diff x \diff t
    = \iint_{K_\tau} f u_t \diff x \diff t
\end{align*}
注意到其左端有
\begin{align*}
    u_t u_{tt} &= \frac12\fracpartials{t}(u_t)^2 \\
    u_t u_{xx} &= \fracpartials{x} (u_t u_x) - \frac12\fracpartials{t}(u_x)^2
\end{align*}
代入积分式中, 得到
\begin{align*}
&\iint_{K_\tau} \biggl(
    \frac12\fracpartials{t}(u_t)^2 - \fracpartials{x} (u_t u_x)
    + \frac12\fracpartials{t}(u_x)^2
    + c u \fracpartial{u}{t} \biggr) \diff x \diff t
    = \iint_{K_\tau} f u_t \diff x \diff t
\end{align*}
对左式应用 Green 公式, 有
\begin{align*}
J &= \oint_{\partial K_\tau} \mclosuresquare{
    a^2 u_t u_x \diff t + \frac12 \bigl(u_t^2 + c u^2 + a^2 u_x^2\bigr)\diff x
}
= \iint_{K_\tau} f u_t \diff x \diff t
\end{align*}
其中 $\partial K_\tau$ 为锥台 $K_\tau$ 的边界, 如果用 $\Gamma_{\tau_1}$ 与
$\Gamma_{\tau_2}$ 表示锥台的面, 则有
\begin{align*}
J &= \int_{\partial K_\tau} \bigl(u_t^2 + c u^2 + a^2 u_x^2\bigr)\diff x
- \int_{\Omega_0} \bigl( \psi_t^2 + c \phi^2 + a^2 \phi_x^2 \bigr) \diff x \\
&\quad- \int_{\Gamma_{\tau_1}^+ \cup \Gamma_{\tau_1}^+} \mclosuresquare{
        a^2 u_t u_x \diff t + \frac12 \bigl(u_t^2 + c u^2 + a^2 u_x^2\bigr)  
    \diff x } \\
&= J_1 + J_2 + J_3
\end{align*}
考察其最后一项
\begin{align*}
J_3 &= -\int_{\tau_1} \biggl\{ a^2 u_t u_x
    + \frac12 \bigl( u_t^2 + c u^2 + a^2 u_x^2 \bigr) a \biggr\} \diff t \\
&\quad+ \int_{\tau_2} \biggl\{ a^2 u_t u_x
    + \frac12 \bigl( u_t^2 + c u^2 + a^2 u_x^2 \bigr) (-a) \biggr\} \diff t \\
&= -\int_{\tau_1} \biggl[ \frac{a}{2}
    \bigl( u_t + a u_x \bigr)^2 + \frac{ac}{2}u^2 \biggr] \diff t
    + \int_{\tau_2} \biggl[ \frac{a}{2}
        \bigl( u_t - a u_x \bigr)^2 + cu^2 \biggr] \diff t \\
&= -\int_{\tau_1} \biggl[ \frac{a}{2}
    \bigl( u_t + a u_x \bigr)^2 + \frac{ac}{2}u^2 \biggr] \diff t
    + \int_{\tau_2} \biggl[ \frac{a}{2}
        \bigl( u_t - a u_x \bigr)^2 + cu^2 \biggr] \diff t \geq 0
\end{align*}
所以有
\begin{align*}
& \iint_{K_\tau} f u_t \diff x \diff t - J_1 - J_2 = J_3 \geq 0 \\
& J_1 \leq -J_2 + \iint_{K_\tau} f u_t \diff x \diff t \\
&\quad\leq -J_2 + \iint_{K_\tau} \mclosure{f u_t + u_t^2} \diff x \diff t
\end{align*}
令 $G(\tau) = \iint_{K_\tau}\mclosure{u_t^2 + c u^2 + a^2 u_x^2}\diff x\diff t$
则有 $\fracdiff{G(\tau)}{\tau} \leq G(\tau) + F(\tau)$, 其中
$F(\tau) = \int_\Omega \bigl( \psi^2 + a^2 \phi_x^2 + c\phi^2 \bigr) \diff x
+\iint_{K_\tau} f^2 \diff x \diff t$.
由 Gronwall 不等式可得
\[ \begin{equlist}
\fracdiff{G(\tau)}{\tau} &= \me^\tau F(\tau) \\
    G(\tau) &\leq (\me^\tau - 1) F(\tau)
\end{equlist} \]
因此, 当 $\phi = \psi = f \equiv 0$ 时, $u \equiv 0$, 故其解唯一, 即证.

下面求解方程, 构造 $v(x, y, t) = u(x, t) \* \exp(\frac{\sqrt{c}}{a}y\mi)$,
可以得到 $v_{xx} = u_{xx} \* \exp(\frac{\sqrt{c}}{a}y\mi)$,
$v_{yy} = \frac{c}{a^2} u \* \exp(\frac{\sqrt{c}}{a}y\mi)$,
$v_{tt} = u_{tt} \* \exp(\frac{\sqrt{c}}{a}y\mi)$, 带入方程中, 得到
\begin{align*}
v_{tt} - a^2 (v_{xx} + v_{yy})
&= u_{tt} \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)
    - a^2 \Biggl(
        u_{xx} \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)
        - \frac{c}{a^2} \* u \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)
    \Biggr) \\
&= u_{tt} \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)
    - a^2 u_{xx} \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)
    + c u \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr) \\
&= \mclosure{u_{tt} - a^2 u_{xx} + cu}
    \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr) \\
&= f(x, t) \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)
\end{align*}

故方程可以转化为
\[ \begin{equlist}
&v_{tt} - a^2 (v_{xx}+v_{yy}) = f(x, t)
    \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)\\
&\mfwhen{v}{t=0} = \phi(x) \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr) \\
&\mfwhen{v_t}{t=0} = \psi(x) \* \exp\mclosure{\frac{\sqrt{c}}{a}}
\end{equlist} \]
令 $d(x, y) = (x_1 -x)^2 + (y_1 - y)^2$, 则由泊松公式可得该方程的解为
\begin{align*}
v(x, y, t) 
&= \frac1{2\pi a} \fracpartials{t} \Biggl[
    \iint_{S_{a t}(x)} \frac{
        \phi(x_1) \* \exp\mclosure{\frac{\sqrt{c}}{a}y\mi} \diff x_1 \diff y_1
    }{
        \sqrt{a^2 t^2 - d(x, y)}
    } 
\Biggr] \\
&\quad+ \frac1{2\pi a} \iint_{S_{a t}(x)} \frac{
    \psi(x_1) \* \exp\mclosure{\frac{\sqrt{c}}{a}y\mi} \diff x_1 \diff y_1
}{
    \sqrt{a^2 t^2 - d(x, y)}
}  \\
&\quad+ \frac1{2\pi a} \int_0^t \iint_{S_{a (t - \tau)}(x)} \frac{
    f(x_1 \tau) \* \exp\mclosure{\frac{\sqrt{c}}{a}} \diff x_1 \diff y_1
}{
    \sqrt{a^2 (t-\tau)^2 - d(x, y)}
} \diff \tau
\end{align*}
于是 $u(x, t) = v(x, y, t) \* \exp\biggl(\frac{\sqrt{c}}{a}y\mi\biggr)$, 其中
\begin{align*}
&d(x, y) \leq a^2 t^2, (x_1, y_1) \in S_{a t}(x) \\
&d(x, y) \leq a^2 (t - \tau)^2, (x_1, y_1) \in S_{a (t - \tau)}(x) \\
&\text{where } d(x, y) = (x_1 -x)^2 + (y_1 - y)^2
\end{align*}
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 13.}
证明以下 Cauchy 问题
\[ \begin{cases}
\dfracpartial{^2u}{t^2} - a^2 \dfracpartial{^2u}{x^2}
 + b(x, t)\dfracpartial{u}{x} + c(x, t)\dfracpartial{u}{t}
 = f(x, t) \\ 
\mfwhen{u}{t=0} = \phi(x), \mfwhen{u_t}{t=0} = \psi(x) \\
-\infty < x < \infty, t > 0
\end{cases} \]
解的唯一性, 其中 $b(x, t)$, $c(x, t)$ 都是有解连续函数.

\begin{solution}
原方程左边右边同时乘以 $u_t$, 并在 $K_\tau$ 上积分, 得
\begin{align*}
& \iint_{K_\tau} u_t \mclosure{
    u_{tt} - a^2 u_{xx} + b u_x + c u_t
} \diff x \diff t
= \iint_{K_\tau} f(x, t) u_t \diff x \diff t \\
\implies & \iint_{K_\tau} u_t \biggl[
    \frac12 \fracpartials{t} \mclosure{u_t^2 + a^2 u_x^2}
    + c u_t^2 + b u_t u_x
    - a^2 \fracpartials{x} \mclosure{u_t u_x}
\biggr] \diff x \diff t = \iint_{K_\tau} f u_t \diff x \diff t
\end{align*}
对上式应用格林公式有
\begin{align*}
J &= -\oint_{\partial K_\tau} \mclosurebrace{
    a^2 u_t u_x \diff t + \frac12 \mclosuresquare{ u_t^2 + a^2 u_x^2 } \diff x
} \\
&= \iint_{K_\tau} \mclosure{ f u_t - (u_t^2 - b u_t u_x) } \diff x \diff t
\end{align*}
对于左边, 又有
\begin{align*}
J &= \frac12 \int_{\Omega_\tau} \mclosure{u_t^2 + cu^2 + a^2 u_x^2} \diff x
- \int_{K_\tau} \mclosure{\psi^2 + c\phi^2 + a^2 \phi_x^2} \diff x
- \int_{\Gamma_{\tau_1}^{+}\cup\Gamma_{\tau_2}^{+}} \mclosure{
    a^2 u_t u_x \diff t
} \\
&\quad- \int_{\Gamma_{\tau_1}^{+}\cup\Gamma_{\tau_2}^{+}} \frac12 \mclosure{
    u_t^2 + c u^2 + a^2 u_x^2
} \diff x \\
&= J_1 + J_2 + J_3 \\
J_3 &= -\frac{a}{2} \int_{\Gamma_{\tau_1}} \mclosure{
    u_t + a u_x
}^2 \diff t + \frac{a}{2} \int_{\Gamma_{\tau_2}} \mclosure{
    u_t - a u_x
}^2 \diff t \\
&\geq 0
\end{align*}
故有
\[
J_3 = \iint_{K_\tau} \mclosure{
    f u_t - (u_t^2 - b u_t u_x)
} \diff x \diff t - J_1 - J_2 \geq 0
\]
整理得
\begin{align*}
\int_{\Omega_\tau} \bigl( u_t^2 + a^2 u_x^2 \bigr) \diff x
&\leq \int_{\Omega_0} \bigl( \psi^2 + a^2 \phi_x^2 \bigr) \diff x
+ 2 \iint_{K_\tau} \bigl( f u_t - c u_t^2 - b u_t u_x \bigr) \diff x \diff t \\
&\leq \int_{\Omega_0} \bigl( \psi^2 + a^2 \phi_x^2 \bigr) \diff x
    + \iint_{K_\tau} f^2\diff x\diff t \\
&\quad+ \iint_{K_\tau} u_t^2\diff x\diff t
    + \max\abs{c} \iint_{K_\tau} u_t^2 \diff x \diff t \\
&\quad+ \max\abs{b} \biggl(
    \iint_{K_\tau} u_t^2 \diff x \diff t
    + \iint_{K_\tau} u_x^2 \diff x \diff t
\biggr) \\
&\leq \int_{\Omega_0} \bigl( \psi^2 + a^2 \phi_x^2 \bigr) \diff x
    +\iint_{K_\tau} f^2\diff x\diff t
    + M \iint_{K_\tau} \bigl( u_t^2 + u_x^2 \bigr) \diff x \diff t
\end{align*}
用类似方法可证唯一性, 不再赘述
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 19.}
求解三维波动方程的 Cauchy 问题:
\[ \begin{cases}
u_{tt} = a^2 (u_{xx} + u_{yy} + u_{zz}), \\
\mfwhen{u}{t=0} = 0, \\
\mfwhen{u_t}{t=0} = x^3 + y^2 z
\end{cases} \]

\begin{solution}
根据泊松公式, 利用球面坐标系可得
\begin{align*}
u(x, y, z, t)
&= \frac{1}{4\pi a^2 t} \int_0^{2\pi} \int_0^\pi \Bigl[
    \bigl( x + at\sin\theta \cos\phi \bigr)^3
    + \mclosure{y + at\sin\theta \sin\phi}^2 (z + at\cos\theta)
    \Bigr] \\
    &\quad a^2 t^2 \sin\theta \diff\theta \diff\phi \\
&= \frac{a^2 t}{4\pi a^2 t} \int_0^{2\pi} \int_0^\pi \Bigl[
    x^3 + 3x^2 at\sin\theta \cos\phi
    + 3x a^2t^2\sin^2\theta \cos^2\phi + a^3t^3\sin^3\theta \cos^3\phi \\
    &\quad+\bigl( y^2 + 2yat\sin\theta \sin\phi + a^2t^2\sin^2\theta
	    \sin^2\phi \bigr) \cdot (z + at\cos\theta) \Bigr]
	    \sin\theta t \diff\theta \diff\phi \\
&=\frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi \Bigl[
    x^3 + 3x^2 at\sin\theta \cos\phi
    + 3x a^2t^2\sin^2\theta \cos^2\phi
    +a^3t^3\sin^3\theta \cos^3\phi \\
    &\quad+\mclosure{
        y^2z + 2yzat\sin\theta \sin\phi + za^2t^2\sin^2\theta \sin^2\phi
    }
    +\bigr(
        y^2at\cos\theta + 2ya^2t^2\sin\theta \cos\theta \sin\phi \\
    &\quad+ a^3t^3\sin^2\theta \cos\theta \sin^2\phi \bigr)
    \Bigr] \sin\theta t \diff\theta \diff\phi
\end{align*}
对每一项求积分, 得
\begin{align*}
J_1 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        x^3 \sin\theta t \diff\theta \diff\phi
    = \frac{1}{4\pi} \int_0^{2\pi} 2x^3t \diff\phi = x^3t \\
J_2 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        3x^2 at^2\sin^2\theta \cos\phi \diff\theta \diff\phi
    = \frac{3\pi}{8\pi} \int_0^{2\pi} x^2at^2 \cos\phi \diff\phi = 0 \\
J_3 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        3x a^2t^3\sin^3\theta \cos^2\phi \diff\theta \diff\phi
    = \frac{1}{\pi} \int_0^{2\pi} xa^2t^2 \cos\phi \diff\phi = xa^2t^3 \\
J_4 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        a^3t^4\sin^4\theta \cos^3\phi \diff\theta \diff\phi
    = \frac{3}{32} \int_0^{2\pi} a^3t^4 \cos^3\phi \diff\phi = 0 \\
J_5 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        y^2z \sin\theta t \diff\theta \diff\phi
    = \frac{1}{4\pi} \int_0^{2\pi} y^2z \diff\phi = y^2zt \\
J_6 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        2yzat^2\sin^2\theta \sin\phi \diff\theta \diff\phi
    = \frac{1}{4} \int_0^{2\pi} yzat^2 \sin\phi \diff\phi = 0 \\
J_7 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        za^2t^3\sin^3\theta \sin^2\phi \diff\theta \diff\phi
    = \frac{1}{3\pi} \int_0^{2\pi} za^2t^2 \sin^2\phi \diff\phi
	    = \frac13za^2t^3 \\
J_8 &= \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi
        y^2at^2\mclosure{\sin\theta\cos\theta} \diff\theta \diff\phi = 0 \\
J_9 &= \frac{2ya^2t^3}{4\pi} \int_0^{2\pi} \int_0^\pi \sin\phi
        \mclosure{\sin^2\theta \cos\theta} \diff\theta \diff\phi = 0 \\
J_{10} &= \frac{a^3t^4}{4\pi} \int_0^{2\pi} \int_0^\pi \sin^2\phi
        \mclosure{\sin^3\theta \cos\theta} \diff\theta \diff\phi = 0
\end{align*}
因此
\begin{align*}
u(x, y, z, t)
&= \sum_i J_i = x^3t + xa^2t^3 + y^2zt + \frac13za^2t^3 \\
&= t(x^3 + y^2z) + a^2t^3(x + \frac{z}{3})
\end{align*}
故其解为 $u(x, y, z, t) = t(x^3 + y^2z) + a^2t^3(x + z/3)$
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 22.}
求特征值问题的特征函数:
\[ \begin{cases}
X''(x) + \lambda X(x) = 0, & 0 < x < l \\
X'(0) = X(l) = 0
\end{cases} \]

\begin{solution}
设 $X(x) = C_1 \sin \sqrt\lambda x + C_2 \cos \sqrt\lambda x$, 令
$\mu = \sqrt\lambda$, ($\mu^2 = \lambda$, $\mu > 0$), 有
$X'(x) = \mu \* (C_1 \* \cos \mu x -  C_2 \* \sin \mu x)$. 带入方程, 有
\begin{align*}
& \mequlist{
    X'(0) &= \mu C_1\cdot 1 - \mu C_2\cdot 0 = 0 \\
    X(l) &= C_1 \sin \mu l + C_2 \cos \mu l
} \\
& C_1 = 0,\ C_2 \cdot \cos \mu l = 0 \\
& \mequlist{
    C_2 &= 0,\ \text{或} \\
    \mu l &= \mclosure{n\pi + \frac{\pi}2},\ n \in \mintg^{+} \cup \{0\}
} \\
\implies & \mu_n = \frac{(2n+1)\pi}{2l}, \lambda_n = \mclosure{
    \frac{(2n+1)\pi}{2l}
}^2 \\
&\text{其中} n \in \mintg^{+} \cup \{0\} \\
\implies & X_n(x) = 0, C_2 \cdot \cos\mclosure{\frac{(2n+1)\pi}{2l}} x \\
\implies & X_n(x) = C_2 \cdot \cos\mclosure{\frac{(2n+1)\pi}{2l}} x
\end{align*}
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{在以下题目中, 令:}
\begin{align*}
Lu &= \fracpartial{^2u}{t^2} - a^2 \fracpartial{^2u}{x^2} \\
Q &= \{ (x, t) | 0 < x < l, t > 0 \}
\end{align*}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 23.}
用分离变量法求解定解问题:
\[ \begin{cases}
Lu = 0, (x, t) \in Q \\
\mfwhen{u}{x=0} = \mfwhen{u_x}{x=l} = 0 \\
\mfwhen{u}{t=0} = \sin^2 \dfrac{\pi x}{l}, \mfwhen{u_t}{t=0} = x(l - x) \\
0 \leq x \leq l,  t \geq 0
\end{cases} \]

\begin{solution}
令 $u = X(x) \cdot T(t)$, 则原方程可以化为 $Lu = XT'' - a^2 X''T = 0$, 分解得
\[ \begin{cases}
T'' + a^2 \lambda T = 0 & t > 0 \\
X'' + \lambda X = 0 & 0 < x < l
\end{cases} \]
对方程
\[ \begin{cases}
X'' + \lambda X = 0 & 0 < x < l \\
X(0) = X'(l) = 0 & 0 \leq x \leq l
\end{cases} \]
代入待定系数的方程 $X(x) = C_1 \sin \mu x + C_2 \cos \mu x$, 其中
$\mu = \sqrt\lambda$, ($\mu^2 = \lambda$, $\mu > 0$), 则有
$X'(x) = \mu C_1 \cos \mu x - \mu C_2 \sin \mu x$. 代入方程中
\begin{align*}
& \mequlist{
    X(0) &= \mu C_1\cdot 0 + \mu C_2\cdot 0 = 1,\ \mu^2 = \lambda,\ \mu > 0 \\
    X'(l) &= \mu C_1 \cos \mu l - \mu C_2 \sin \mu l
} \\
& C_2 = 0,\ C_1 \cdot \cos \mu l = 0 \\
& \mu_n = \frac{(2n+1)\pi}{2l} \\
& X(x) = \sin \mclosure{\frac{(2n+1)\pi}{2l}} x, 0 < x < l
\end{align*}
对于 ODE $T'' + a^2\lambda T = 0$, $t > 0$ 有解
$T_n(t) = A_n \sin a \mu t + B_n \cos a \mu t$, $n = 1, 2, \ldots$, 带回方程中,
$u_n = \mclosure{A_n \sin a \mu t + B_n \cos a \mu t} \sin \mu x, (x, t) \in Q$,
对其求和 $u = \sum u_n$.

考察边界条件, 当 $t = 0$ 时, 对 $u$ 和 $u_t$ 有
\begin{align*}
u &= \sum \mclosuresquare{
    \mclosure{A_n \cdot 0 + B_n \cdot 1} \cdot \sin \mu x
} = x(x - 2l) \\
&= \sum \mclosure{B_n \sin \mu x} = x(x - 2l) \\
u_t &= \sum \mclosuresquare{
    \mclosure{a \mu A_n \cos a \mu t - a \mu B_n \sin a \mu t} \cdot \sin \mu x
} \\
&= \sum \mclosuresquare{
    \mclosure{a \mu A_n \cdot 1 - a \mu B_n \cdot 0} \cdot \sin \mu x
} \\
&= \sum \mclosure{a \mu A_n \cdot \sin \mu x} = 0
\end{align*}
分别求解方程, 得到
\[ A_n = 0, \quad B_n = \frac{
    \int_0^l x(x-2l)\sin \mu x \diff x
}{
    \int_0^l \mclosure{\sin \mu x}^2 \diff x 
} \]
带回原方程, 得到原方程的解
\begin{align*}
&u = \sum \mclosure{B_n \cos a \mu t \sin \mu x} \\
&\text{where } B_n = \frac{
    \int_0^l x(x-2l)\sin \mu x \diff x
}{
    \int_0^l \mclosure{\sin \mu x}^2 \diff x 
}, \mu = \frac{(2n+1)\pi}{2l}.
\end{align*}
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 25.}
设 $u(x, t)$ 适合定解问题:
\[ \begin{cases}
Lu = 0, (x, t) \in Q \\
-\dfracpartial{u}{x} + \alpha \mfwhen{u}{x=0} = \mu_1(t), & t \geq 0 \\
\dfracpartial{u}{x} + \beta \mfwhen{u}{x=l} = \mu(t), & t \geq 0 \\
\mfwhen{u}{t=0} = \phi(x), \mfwhen{u_t}{t=0} = \psi(x), & 0 \leq x \leq l
\end{cases} \]
试引进辅助函数, 把边条件齐次化, 设: (a) $\alpha > 0$, $\beta > 0$; (b)
$\alpha = \beta = 0$.

\begin{solution}
\noindent (第一类边值条件): 构造
\[w_1 = \frac{l-x}{l}g_1(t) + \frac xl g_2(t)\]
则有 $v_1 = u - w_1$, 即可完成转换.

\noindent (第二类边值条件): 构造
\[w_2 = \mclosure{\frac{l-x}{2l}}^2 g_1(t) + \frac{x^2}{2l} g_2(t)\]
则有 $v_2 = u - w_2$, 即可完成转换.

\noindent (第三类边值条件): 构造
\[
w_3 = \frac{1 + \beta l- \beta x}{\alpha + \beta + \alpha\beta l} g_1(t)
+ \frac{1 + \alpha x}{\alpha + \beta + \alpha\beta l} g_2(t)
\]
则有 $v_3 = u - w_3$, 即可完成转换.
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 26.}
用分离变量法求解下列定解问题:
\[ \begin{cases}
Lu = A, (x, t) \in Q \\
\mfwhen{u}{x=0} = 0, \mfwhen{u}{x=l} = B, t \geq 0 \\
\mfwhen{u}{t=0} = \dfrac{Bx}{l}, \mfwhen{u_t}{t=0} = 0, 0 \leq x \leq l
\end{cases} \]

\begin{solution}
$\tilde{u} = \tilde{u}(x, t) = X(x) \cdot T(t)$, 且 $\tilde{u}$ 适定于方程组
\[ \begin{cases}
L\tilde{u} = \fracpartial{^2\tilde{u}}{t^2} - a^2 \fracpartial{^2\tilde{u}}{x^2}
 = A, (x, t) \in Q \\
\mfwhen{\tilde{u}}{x=0} = \mfwhen{\tilde{u}}{x=l} = 0, t \geq 0 \\
\mfwhen{\tilde{u}}{t=0} = \mfwhen{\tilde{u}_t}{t=0} = 0, 0 \leq x \leq l
\end{cases} \]
对方程求特征值 $L\tilde{u} = XT'' - a^2 X''T = 0$
\[ \implies \begin{cases}
    X'' + \lambda X = 0, & 0 < x < l \\
    T'' + a^2 \lambda T = 0, & t \geq 0
\end{cases} \]
对 $X'' + \lambda X = 0$ 代入待定系数解
$X(x) = C_1 \sin \beta x + C_2 \cos \beta x$,($\beta^2 = \lambda$, $\beta > 0$),
考察边界条件, 有
\[ \begin{equlist}
    X(0) &= C_1 \cdot 0 + C_2 \cdot 1 = 0 \\
    X(l) &= C_1 \sin \beta l + C_2 \cos \beta l = 0
\end{equlist} \]
\[ \implies \begin{equlist}
    C_2 &= 0 \\
    C_1 \sin \beta l &= 0
\end{equlist} \implies
\beta = \frac{n\pi}{l}, \lambda = \mclosure{\frac{n\pi}{l}}^2
\]
对 $T'' + a^2 \lambda T = 0$, 有解 $T_n(t) =A_n\sin a\beta t +B_n\cos a\beta t$,
代回方程中, 进一步得到
$\tilde{u}_n(x, t) = T_n(t)\cdot X(x)
= (A_n \sin a \beta t + B_n \cos a \beta t) \sin\beta x$.
\[
\tilde{u} = \sum^\infty_{n = 1} \tilde{u}_n(x, t)
= \sum^\infty_{n = 1} \bigl[
     (A_n \sin a \beta t + B_n \cos a \beta t) \sin\beta x
\bigr]
\]
考虑到方程的初值, 有
\[ \implies \begin{equlist}
\mfwhen{\tilde{u}}{t=0} &= \sum^\infty_{n = 1} \mclosuresquare{
    \mclosure{A_n \cdot 0 + B_n \cdot 1} \cdot \sin\beta x
} \\
\mfwhen{\tilde{u}_t}{t=0} &= \sum^\infty_{n = 1} \mclosuresquare{
    a \beta \mclosure{A_n \cdot 1 + B_n \cdot 0} \cdot \sin\beta x
}
\end{equlist} \]
\[ \ \begin{equlist}
\sum B_n \sin \beta x = 0 \\
\sum A_n \sin \beta x = 0
\end{equlist} \implies \begin{equlist}
\sum^\infty_{n=1} B_n \sin \frac{n\pi}{l} x = 0 \\
\sum^\infty_{n=1} A_n \sin \frac{n\pi}{l} x = 0
\end{equlist} \]
回到一开始的 $\tilde{u}$ 的意义, $\tilde{u}$ 满足方程的约束, 其构造方程式为
\[ \tilde{u} = u - \frac Bl x \]
故此时有:
$\mathcal{F}\mclosure{\fracpartial{^2u}{t^2}}(t)
+ \mclosure{\frac{an\pi}{l}}^2 \mathcal{F}(u)(t) = \mathcal{F}(f)(t)$.
其中算子 $\mathcal{F}(u)$ 表示将
$\mathcal{F}u = \sum^\infty_{n=1} u_n \sin\frac{n\pi}{l}x$, $u_n$ 
为 Fourier 系数.
同时有
\[ \begin{equlist}
\mathcal{F}\mclosure{u}\mclosure{0} = \mathcal{F}\mclosure{\frac{Bx}{l}} \\
\mathcal{F}\mclosure{\fracpartial{u}{t}}\mclosure{0} = \mathcal{F}\mclosure{0}
\end{equlist} \]
记 $w_n = \frac{an\pi}{l}$, 综上, 有
\begin{align*}
\tilde{u}_n(t) &= \frac{1}{w_n} \int_0^t \mclosuresquare{
    \frac{2}{l} \int_0^l A \sin \frac{n\pi}{l}x \diff x
} \\
&\quad\cdot \sin w_n (t - \tau) \diff \tau \sin \frac{n\pi}{l} x \\
\tilde{u}(t) &= \sum_{n=0}^\infty u_n(t) = \sum_{n=0}^\infty \frac{
    4 A (1 -\cos w_n t) }{ (2n+1)a\pi w_n } \cdot  \sin \frac{n\pi}{l}x 
\end{align*}
整理得
\begin{align*} \implies
\tilde{u}(t) &= \sum_{n=0}^\infty \frac{4A(1 -\cos w_n t)}{(2n+1)a\pi w_n}
\cdot \sin \frac{n\pi}{l}x \\
u(t) &= \tilde{u}(t) + \frac{B}{l} x, w_n = \frac{an\pi}{l}
\end{align*}
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\paragraph{Ex 28.}
用能量不等式证明一维波动方程带有第三边值条件的初边值问题解的唯一性.

\begin{solution}
$u$ 适定于方程
\[ \begin{cases}
u_{tt} - a^2 u_{xx} = f \\
\mfwhen{u}{t=0} = \phi, \mfwhen{u_t}{t=0} = \psi \\
\mfwhen{\mclosure{-u_x + \alpha u}}{x=0} = 0,
\mfwhen{\mclosure{u_x + \beta u}}{x=0} = 0
\end{cases} \]
同乘 $u_t$ 并且积分, 得到
\[
\iint_Q u_t (u_{tt} - a^2 u_{xx}) \diff x \diff t
= \iint_{Q_\tau} u_t f \diff x \diff t
\]
\[
\iint_Q \mclosuresquare{\frac12 \bigl( u_t^2 \bigr)_t
    + \frac12 a^2 \bigl( u_x^2 \bigr)_t
    - \bigl( a^2 u_t u_x \bigr)_x } \diff x \diff t
= \iint_{Q_\tau} u_t f \diff x \diff t
\]
套用 Green 公式
\[
J = -\oint_{\partial Q_r} \mclosuresquare{
    \mclosure{\frac12 u_t^2 + \frac12 a^2 u_x^2} \diff x
    + a^2 u_t u_x \diff t
} = \iint_{Q_r} u_t f \diff x \diff t
\]
逐项考虑
\begin{align*}
J &= J_1 + J_2 + J_3 \\
&= \frac12 \int_{\Omega_r} \Bigl[
    \bigl( u_t^2 \bigr) + a^2 \bigl( u_x^2 \bigr)
    \Bigr] \diff x - \frac12 \int_{\Omega_0} \Bigl[
    \bigl( \psi^2 \bigr) + a^2 \bigl( \phi_x^2 \bigr)
    \Bigr] \diff x \\
&= \int_{\Gamma_{\tau_1} \cup \Gamma_{\tau_2}} \biggl\{
    a^2 u_t u_x \diff t + \frac{a^2}{2} \Bigl[
    \bigl( u_t^2 \bigr) + \bigl( u_x^2 \bigr)
    \Bigr] \diff x \biggr\}
\end{align*}
在 $\Gamma_{\tau_1}$ 上, $\diff x = 0$, $u_x = \alpha u$, 故有
\begin{align*}
-\int_{\Gamma_{\tau_1}^+} &=
    \int_0^{\tau} \mfwhen{a^2u_t\alpha u)}{x=0} \diff t
= \frac{\alpha a^2}{2} \mfwhen{
    \mclosure{\int_0^\tau \fracpartials{t} \mclosure{u^2} \diff t}
    }{x=0}
= \frac{\alpha a^2}{2} \mclosuresquare{u^2(0, t) - \phi^2(0)}
\end{align*}
同理, 有
\[
-\int_{\Gamma_{\tau_2}^+} =
\frac{\beta a^2}{2} \mclosuresquare{u^2(l, \tau) - \phi^2(l)}
\]
故有
\[
\int_0^l \mclosuresquare{u_t^2(x, \tau) + a^2 u_x^2(x, \tau)} \diff x
\leq \int_0^l (\psi^2 + a^2 \phi_x^2) \diff x + \alpha a^2 \phi^2(0)
    + \beta a^2 \phi^2(l) \\+ \iint_{Q_\tau} f^2 \diff x \diff t
 + \iint_{Q_\tau} u_t^2 \diff x \diff t
\]
令 $G(\tau) = \iint_{Q_\tau} (u_t^2 + a^2 u_x^2) \diff x \diff t$, 当 $G(0)=0$
时, 有 $\fracdiff{G(\tau)}{\tau} = G(\tau) + F(\tau)$, 即
\begin{align*}
\int_0^l \mfwhen{\mclosure{u_t^2 + a^2 u_x^2}}{t=\tau} \diff x
&\leq M(t) \Bigl(
    \int_0^l \mclosure{\psi^2 + a^2 \phi_x^2} \diff x
    + \alpha a^2 \phi(0) + \beta a^2 \phi(l)
        + \iint_{Q_\tau} f^2 \diff x \diff t \Bigr) \\
\iint_{Q_\tau} \mclosure{u_t^2 + a^2 u_x^2} \diff x \diff t
&\leq M(t) \Bigl(
    \int_0^l \mclosure{\psi^2 + a^2 \phi_x^2} \diff x
    + \alpha a^2 \phi(0) + \beta a^2 \phi(l)
        + \iint_{Q_\tau} f^2 \diff x \diff t \Bigr)
\end{align*}
\qed
\end{solution}
%==============================================================================%
%------------------------------------------------------------------------------%
%==============================================================================%
\endinput
